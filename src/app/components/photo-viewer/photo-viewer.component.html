<div
  class="container-fluid viewer py-3"
  *ngIf="album && currentPhoto; else noPhoto"
  [ngClass]="{ 'slideshow-mode': isSlideshowActive }"
>
  <div class="controls mb-3">
    <div class="btn-group mr-2" role="group">
      <button class="btn btn-outline-primary" (click)="previousPhoto()">
        <i class="bi bi-chevron-left"></i> Previous
      </button>
      <button class="btn btn-outline-primary" (click)="nextPhoto()">
        Next <i class="bi bi-chevron-right"></i>
      </button>
    </div>

    <button class="btn btn-outline-success mr-2" (click)="toggleSlideshow()">
      <i class="bi" [ngClass]="isSlideshowActive ? 'bi-pause' : 'bi-play'"></i>
      {{ isSlideshowActive ? "Pause" : "Slideshow" }}
    </button>

    <button class="btn btn-outline-warning" (click)="toggleFavorite()">
      <i
        class="bi"
        [ngClass]="currentPhoto.isFavorite ? 'bi-star-fill' : 'bi-star'"
      ></i>
      Favorite
    </button>

    <div class="card-body p-2">
      <div class="btn-group" role="group">
        <button class="btn btn-outline-dark" (click)="zoomIn()">
          <i class="bi bi-plus-lg"></i>
        </button>
        <button class="btn btn-outline-info mr-2" (click)="resetZoom()">
          <i class="bi bi-arrow-counterclockwise"></i> Reset
        </button>
        <button class="btn btn-outline-dark" (click)="zoomOut()">
          <i class="bi bi-dash-lg"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="photo-container card">
    <div
      class="image-wrapper"
      [style.transform]="
        'scale(' +
        scale +
        ') translate(' +
        translateX +
        'px, ' +
        translateY +
        'px)'
      "
    >
      <img
        [src]="currentPhoto.url"
        [alt]="currentPhoto.title"
        class="card-img-top photo img-fluid"
        loading="lazy"
      />
    </div>

    <div class="card-body photo-info" [hidden]="isSlideshowActive">
      <h2 class="card-title h4">{{ currentPhoto.title }}</h2>
      <p class="card-text text-muted">
        <small>Added: {{ currentPhoto.dateAdded | date }}</small>
      </p>
      <p class="card-text" *ngIf="currentPhoto?.tags?.length">
        <span
          class="badge bg-secondary me-1"
          *ngFor="let tag of currentPhoto.tags"
        >
          {{ tag }}
        </span>
      </p>
    </div>
  </div>
</div>

<ng-template #noPhoto>
  <div class="container py-5">
    <div class="alert alert-warning text-center" role="alert">
      <h4 class="alert-heading">Oops!</h4>
      <p>Photo or album not found</p>
      <a routerLink="/albums" class="btn btn-primary mt-2">
        <i class="bi bi-arrow-left-circle"></i> Return to Albums
      </a>
    </div>
  </div>
</ng-template>

<style>
  .viewer {
    background-color: #f8f9fa;
    min-height: 100vh;
  }

  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 1rem;
    background-color: #fff;
    border-radius: 0.375rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .photo-container {
    position: relative;
    background-color: #fff;
    overflow: hidden; /* Prevent image from overflowing */
    max-height: 70vh; /* Set a maximum height */
  }

  .image-wrapper {
    transition: transform 0.2s ease;
    position: relative;
    display: inline-block; /* Ensure wrapper matches image size */
  }

  .photo {
    max-width: 100%;
    height: auto;
    object-fit: contain;
    display: block;
  }

  .photo-info {
    padding: 1rem;
  }

  .slideshow-mode .photo-container {
    border: none;
    box-shadow: none;
  }
</style>
