<div class="album-detail bg-white py-5" *ngIf="album; else noAlbum">
  <!-- Header Section -->
  <header class="header-section container mb-5">
    <h2 class="album-title display-4 fw-bold text-primary">{{ album.name }}</h2>
  </header>

  <!-- Main Content Grid -->
  <div class="content-grid container">
    <!-- Add Photo Form -->
    <div class="add-photo-section mb-5">
      <h3 class="h5 fw-semibold text-dark mb-3">Upload New Image</h3>
      <div class="add-photo-form card p-4 shadow-sm border-0">
        <div class="mb-3">
          <label for="photo-title-input" class="form-label fw-medium"
            >Caption</label
          >
          <input
            id="photo-title-input"
            type="text"
            class="form-control rounded-3"
            [(ngModel)]="newPhotoTitle"
            placeholder="Image Caption"
            required
          />
        </div>
        <div class="mb-3">
          <label for="photo-url-input" class="form-label fw-medium"
            >Image URL</label
          >
          <input
            id="photo-url-input"
            type="url"
            class="form-control rounded-3"
            [(ngModel)]="newPhotoUrl"
            placeholder="Image Link"
            required
          />
        </div>

        <button
          class="btn btn-primary w-100 rounded-pill fw-medium"
          (click)="addPhoto()"
          [disabled]="!newPhotoTitle || !newPhotoUrl"
        >
          <span class="button-text">Add Image</span>
        </button>
      </div>
    </div>

    <!-- Controls Section -->
    <div class="controls-section mb-5">
      <div class="row g-4 align-items-end">
        <div class="col-md-4" *ngIf="selectedPhotoIds.length > 0">
          <button
            class="btn btn-danger w-100 rounded-pill fw-medium"
            (click)="bulkDelete()"
          >
            Remove Selected ({{ selectedPhotoIds.length }})
          </button>
        </div>
      </div>
    </div>

    <!-- Photo Grid Section -->
    <div class="photo-grid-section">
      <h3 class="h5 fw-semibold text-dark mb-4">Images</h3>
      <div
        class="row row-cols-1 row-cols-md-3 g-4"
        *ngIf="filterPhotos().length > 0; else noPhotos"
      >
        <div *ngFor="let photo of filterPhotos()" class="col">
          <div
            class="card h-100 photo-card shadow-sm border-0 overflow-hidden"
            draggable="true"
            (dragstart)="onDragStart($event, photo.id)"
            (dragover)="onDragOver($event)"
            (drop)="onDrop($event, photo.id)"
          >
            <div class="card-body position-relative p-3">
              <span
                class="custom-checkbox position-absolute top-0 start-0 m-3 bg-white rounded-circle"
                [ngClass]="{ checked: selectedPhotoIds.includes(photo.id) }"
                (click)="
                  togglePhotoSelection(photo.id); $event.stopPropagation()
                "
              ></span>
              <a [routerLink]="['/viewer', album.id, photo.id]">
                <img
                  [src]="photo.url"
                  [alt]="photo.title"
                  class="card-img-top photo-image rounded-3"
                />
              </a>
              <div class="photo-info mt-3">
                <h6 class="card-title photo-title fw-semibold">
                  {{ photo.title }}
                </h6>
                <p class="card-text text-muted photo-date mb-2">
                  Detail: {{ photo.dateAdded | date }}
                </p>
                <div class="photo-tags" *ngIf="photo.tags?.length">
                  <span
                    class="badge bg-info me-1 py-1 px-2 rounded-pill"
                    *ngFor="let tag of photo.tags"
                    >{{ tag }}</span
                  >
                </div>
              </div>
              <div class="button-group mt-3 d-flex gap-2">
                <button
                  class="btn btn-sm btn-outline-primary rounded-pill flex-grow-1"
                  (click)="openEditModal(photo)"
                >
                  Edit
                </button>
                <button
                  class="btn btn-sm btn-outline-danger rounded-pill flex-grow-1"
                  (click)="deletePhoto(photo.id)"
                >
                  Delete
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Humorous No Photos Message -->
      <ng-template #noPhotos>
        <div class="text-center rounded-3 shadow-sm">
          <h4 class="fw-semibold">No Photos Available</h4>
        </div>
      </ng-template>
    </div>

    <!-- Edit Modal -->
    <div
      class="modal fade show d-block"
      *ngIf="showEditModal"
      tabindex="-1"
      (click)="closeEditModal($event)"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content shadow-lg border-0 rounded-3">
          <div class="modal-header bg-light">
            <h3 class="modal-title h5 fw-semibold">Modify Image Details</h3>
          </div>
          <div class="modal-body p-4">
            <div class="mb-3">
              <label for="edit-title" class="form-label fw-medium"
                >Caption</label
              >
              <input
                id="edit-title"
                type="text"
                class="form-control rounded-3"
                [(ngModel)]="editTitle"
                placeholder="Update Caption"
                required
              />
            </div>
            <div class="mb-3">
              <label for="edit-url" class="form-label fw-medium"
                >Image URL</label
              >
              <input
                id="edit-url"
                type="url"
                class="form-control rounded-3"
                [(ngModel)]="editUrl"
                placeholder="Update Link"
                required
              />
            </div>
          </div>
          <div class="modal-footer bg-light">
            <button
              class="btn btn-success rounded-pill px-4 fw-medium"
              (click)="saveEdit()"
            >
              Confirm
            </button>
            <button
              class="btn btn-secondary rounded-pill px-4 fw-medium"
              (click)="closeEditModal()"
            >
              Discard
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #noAlbum>
  <div class="alert alert-danger text-center m-4 rounded-3 shadow-sm">
    <p class="fw-semibold mb-2">Collection not located</p>
    <a
      class="btn btn-outline-primary rounded-pill px-4 fw-medium"
      routerLink="/albums"
    >
      Back to Collections
    </a>
  </div>
</ng-template>
